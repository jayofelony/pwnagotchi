{% extends "base.html" %}
{% set active_page = "bt-tether" %}
{% block title %}
{{ title }}
{% endblock %}
{% block meta %}
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, user-scalable=0" />
{% endblock %}
{% block styles %}
{{ super() }}
<style>
    h1.used {
        color: green;
    }

    h1.notused {
        color: orangered;
    }
    #searchText {
        width: 100%;
    }

    table {
        table-layout: auto;
        width: 100%;
    }

    table,
    th,
    td {
        border: 1px solid;
        border-collapse: collapse;
    }

    th,
    td {
        padding: 15px;
        text-align: center;
    }

    @media screen and (max-width:700px) {

        table,
        tr,
        td {
            padding: 0;
            border: 1px solid;
        }

        table {
            border: none;
        }

        tr:first-child,
        thead,
        th {
            display: none;
            border: none;
        }

        tr {
            float: left;
            width: 100%;
            margin-bottom: 2em;
        }

        td {
            float: left;
            width: 100%;
            padding: 1em;
        }

        td::before {
            content: attr(data-label);
            word-wrap: break-word;
            color: white;
            border-right: 2px solid;
            width: 20%;
            float: left;
            padding: 1em;
            font-weight: bold;
            margin: -1em 1em -1em -1em;
        }
    }
</style>
{% endblock %}
{% block script %}
var searchInput = document.getElementById("searchText");
searchInput.onkeyup = function() {
    var filter, table, tr, td, i, txtValue;
    filter = searchInput.value.toUpperCase();
    table = document.getElementById("tableOptions");
    if (table) {
        tr = table.getElementsByTagName("tr");

        for (i = 0; i < tr.length; i++) { 
            td=tr[i].getElementsByTagName("td")[0]; 
            if (td) { 
                txtValue=td.textContent || td.innerText; 
                if (txtValue.toUpperCase().indexOf(filter)> -1) {
                    tr[i].style.display = "";
                }
                else {
                    tr[i].style.display = "none";
                }
            }
        }
    }
}
{% endblock %}

{% block content %}
<input type="text" id="searchText" placeholder="Search for ..." title="Type in a filter">
<table id="tableOptions">
    <tr>
        <th>Phone</th>
        <th>States</th>
    </tr>
    {% for key in phones %}
    <tr>
        <td data-label="phone">
            {% if key == active_phone %}
            {% set header_class="used" %}
            {% else %}
            {% set header_class="notused" %}
            {% endif %}
            <h1 class="{{header_class}}">{{phones[key].phone_name}} ({{phones[key].phone}})</h1>
            <strong>IP:&nbsp;</strong>{{phones[key].ip}}&nbsp;<strong>Gateway:&nbsp;</strong>{{phones[key].gateway}}<br>
            <strong>DNS: </strong>{{phones[key].dns.replace(" ", ",&nbsp;")|safe}}<br>
            <strong>MAC: </strong>{{phones[key].mac}}<br>
        </td>
        <td>
            <strong>NetworkManager&nbsp;Connection: </strong>{{phones[key].connection_state.name}}{% if phones[key].up_date != None %}{% set up_date_ago=phones[key].up_date_ago %}&nbsp;({{up_date_ago[0]}}min&nbsp;{{up_date_ago[1]}}s){% endif %}<br>
            <strong>NetworkManager&nbsp;Device: </strong>{{phones[key].device_state.name}}<br>
            <strong>Bluetooth: </strong>{{phones[key].bluetooth_state.name}}<br>
        </td>
    </tr>
    {% endfor %}
</table>
{% endblock %}